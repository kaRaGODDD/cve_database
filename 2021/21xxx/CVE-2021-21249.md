
# [CVE-2021-21249](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21249)

## Description

- `OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is an issue involving YAML parsing which can lead to post-auth remote code execution. In order to parse and process YAML files, OneDev uses SnakeYaml which by default (when not using `SafeConstructor`) allows the instantiation of arbitrary classes. We can leverage that to run arbitrary code by instantiating classes such as `javax.script.ScriptEngineManager` and using `URLClassLoader` to load the script engine provider, resulting in the instantiation of a user controlled class. For a full example refer to the referenced GHSA. This issue was addressed in 4.0.3 by only allowing certain known classes to be deserialized`

## Cvss Data

- **Access Vector**:
  - NETWORK
- **Base Score**:
  - 6.5

## Scores

- **Exploitability Score**:
  - 8.0
- **Impact Score**:
  - 6.4
- **Base Severity**:
  - MEDIUM

## Other Information

- **Publish Date**:
  - 2021-01-15 21:15:13
- **Vulnerability Status**:
  - Analyzed

## References

- **security-advisories@github.com**: https://github.com/theonedev/onedev/commit/d6fc4212b1ac1e9bbe3ce444e95f9af1e3ab8b66
- **security-advisories@github.com**: https://github.com/theonedev/onedev/security/advisories/GHSA-7xhq-m2q9-6hpm
