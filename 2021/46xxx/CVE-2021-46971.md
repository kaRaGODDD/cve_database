
# [CVE-2021-46971](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46971)

## Description

- `In the Linux kernel, the following vulnerability has been resolved:perf/core: Fix unconditional security_locked_down() callCurrently, the lockdown state is queried unconditionally, even thoughits result is used only if the PERF_SAMPLE_REGS_INTR bit is set inattr.sample_type. While that doesn't matter in case of the Lockdown LSM,it causes trouble with the SELinux's lockdown hook implementation.SELinux implements the locked_down hook with a check whether the currenttask's type has the corresponding "lockdown" class permission("integrity" or "confidentiality") allowed in the policy. This meansthat calling the hook when the access control decision would be ignoredgenerates a bogus permission check and audit record.Fix this by checking sample_type first and only calling the hook whenits result would be honored.`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2024-02-27 19:04:07
- **Vulnerability Status**:
  - Awaiting Analysis

## References

- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/08ef1af4de5fe7de9c6d69f1e22e51b66e385d9b
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/4348d3b5027bc3ff6336368b6c60605d4ef8e1ce
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/b246759284d6a2bc5b6f1009caeeb3abce2ec9ff
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/c7b0208ee370b89d20486fae71cd9abb759819c1
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/f5809ca4c311b71bfaba6d13f4e39eab0557895e
