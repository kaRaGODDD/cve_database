
# [CVE-2021-46912](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46912)

## Description

- `In the Linux kernel, the following vulnerability has been resolved:net: Make tcp_allowed_congestion_control readonly in non-init netnsCurrently, tcp_allowed_congestion_control is global and writable;writing to it in any net namespace will leak into all other netnamespaces.tcp_available_congestion_control and tcp_allowed_congestion_control arethe only sysctls in ipv4_net_table (the per-netns sysctl table) with aNULL data pointer; their handlers (proc_tcp_available_congestion_controland proc_allowed_congestion_control) have no other way of referencing astruct net. Thus, they operate globally.Because ipv4_net_table does not use designated initializers, there is noeasy way to fix up this one "bad" table entry. However, the data pointerupdating logic shouldn't be applied to NULL pointers anyway, so weinstead force these entries to be read-only.These sysctls used to exist in ipv4_table (init-net only), but they weremoved to the per-net ipv4_net_table, presumably without realizing thattcp_allowed_congestion_control was writable and thus introduced a leak.Because the intent of that commit was only to know (i.e. read) "whichcongestion algorithms are available or allowed", this read-only solutionshould be sufficient.The logic added in recent commit31c4d2f160eb: ("net: Ensure net namespace isolation of sysctls")does not and cannot check for NULL data pointers, becauseother table entries (e.g. /proc/sys/net/netfilter/nf_log/) have.data=NULL but use other methods (.extra2) to access the struct net.`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2024-02-27 07:15:07
- **Vulnerability Status**:
  - Awaiting Analysis

## References

- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/1ccdf1bed140820240e383ba0accc474ffc7f006
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/35d7491e2f77ce480097cabcaf93ed409e916e12
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/97684f0970f6e112926de631fdd98d9693c7e5c1
