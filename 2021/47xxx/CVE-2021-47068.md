
# [CVE-2021-47068](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47068)

## Description

- `In the Linux kernel, the following vulnerability has been resolved:net/nfc: fix use-after-free llcp_sock_bind/connectCommits 8a4cd82d ("nfc: fix refcount leak in llcp_sock_connect()")and c33b1cc62 ("nfc: fix refcount leak in llcp_sock_bind()")fixed a refcount leak bug in bind/connect but introduced ause-after-free if the same local is assigned to 2 different sockets.This can be triggered by the following simple program:    int sock1 = socket( AF_NFC, SOCK_STREAM, NFC_SOCKPROTO_LLCP );    int sock2 = socket( AF_NFC, SOCK_STREAM, NFC_SOCKPROTO_LLCP );    memset( &addr, 0, sizeof(struct sockaddr_nfc_llcp) );    addr.sa_family = AF_NFC;    addr.nfc_protocol = NFC_PROTO_NFC_DEP;    bind( sock1, (struct sockaddr*) &addr, sizeof(struct sockaddr_nfc_llcp) )    bind( sock2, (struct sockaddr*) &addr, sizeof(struct sockaddr_nfc_llcp) )    close(sock1);    close(sock2);Fix this by assigning NULL to llcp_sock->local after callingnfc_llcp_local_put.This addresses CVE-2021-23134.`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2024-02-29 23:15:08
- **Vulnerability Status**:
  - Awaiting Analysis

## References

- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/18175fe17ae043a0b81e5d511f8817825784c299
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/18ae4a192a4496e48a5490b52812645d2413307c
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/26157c82ba756767b2bd66d28a71b1bc454447f6
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/374cdde4dcc9c909a60713abdbbf96d5e3e09f91
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/48fba458fe54cc2a980a05c13e6c19b8b2cfb610
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/6b7021ed36dabf29e56842e3408781cd3b82ef6e
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/c61760e6940dd4039a7f5e84a6afc9cdbf4d82b6
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/ccddad6dd28530e716448e594c9ca7c76ccd0570
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/e32352070bcac22be6ed8ab635debc280bb65b8c
