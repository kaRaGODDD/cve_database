
# [CVE-2021-47125](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47125)

## Description

- `In the Linux kernel, the following vulnerability has been resolved:sch_htb: fix refcount leak in htb_parent_to_leaf_offloadThe commit ae81feb7338c ("sch_htb: fix null pointer dereferenceon a null new_q") fixes a NULL pointer dereference bug, but itis not correct.Because htb_graft_helper properly handles the case when new_qis NULL, and after the previous patch by skipping this callwhich creates an inconsistency : dev_queue->qdisc will stillpoint to the old qdisc, but cl->parent->leaf.q will point tothe new one (which will be noop_qdisc, because new_q was NULL).The code is based on an assumption that these two pointers arethe same, so it can lead to refcount leaks.The correct fix is to add a NULL pointer check to protectqdisc_refcount_inc inside htb_parent_to_leaf_offload.`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2024-03-15 21:15:07
- **Vulnerability Status**:
  - Awaiting Analysis

## References

- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/2411c02d03892a5057499f8102d0cc1e0f852416
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/944d671d5faa0d78980a3da5c0f04960ef1ad893
