
# [CVE-2023-52480](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52480)

## Description

- `In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix race condition between session lookup and expire Thread A                        +  Thread B ksmbd_session_lookup            |  smb2_sess_setup   sess = xa_load                |                                 |                                 |    xa_erase(&conn->sessions, sess->id);                                 |                                 |    ksmbd_session_destroy(sess) --> kfree(sess)                                 |   // UAF!                       |   sess->last_active = jiffies   |                                 +This patch add rwsem to fix race condition between ksmbd_session_lookupand ksmbd_expire_session.`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2024-02-29 06:15:46
- **Vulnerability Status**:
  - Awaiting Analysis

## References

- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/18ced78b0ebccc2d16f426143dc56ab3aad666be
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/53ff5cf89142b978b1a5ca8dc4d4425e6a09745f
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/a2ca5fd3dbcc665e1169044fa0c9e3eba779202b
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/c77fd3e25a51ac92b0f1b347a96eff6a0b4f066f
