
# [CVE-2023-52568](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52568)

## Description

- `In the Linux kernel, the following vulnerability has been resolved:x86/sgx: Resolves SECS reclaim vs. page fault for EAUG raceThe SGX EPC reclaimer (ksgxd) may reclaim the SECS EPC page for anenclave and set secs.epc_page to NULL. The SECS page is used for EAUGand ELDU in the SGX page fault handler. However, the NULL check forsecs.epc_page is only done for ELDU, not EAUG before being used.Fix this by doing the same NULL check and reloading of the SECS page asneeded for both EAUG and ELDU.The SECS page holds global enclave metadata. It can only be reclaimedwhen there are no other enclave pages remaining. At that point,virtually nothing can be done with the enclave until the SECS page ispaged back in.An enclave can not run nor generate page faults without a resident SECSpage. But it is still possible for a #PF for a non-SECS page to racewith paging out the SECS page: when the last resident non-SECS page Atriggers a #PF in a non-resident page B, and then page A and the SECSboth are paged out before the #PF on B is handled.Hitting this bug requires that race triggered with a #PF for EAUG.Following is a trace when it happens.BUG: kernel NULL pointer dereference, address: 0000000000000000RIP: 0010:sgx_encl_eaug_page+0xc7/0x210Call Trace: ? __kmem_cache_alloc_node+0x16a/0x440 ? xa_load+0x6e/0xa0 sgx_vma_fault+0x119/0x230 __do_fault+0x36/0x140 do_fault+0x12f/0x400 __handle_mm_fault+0x728/0x1110 handle_mm_fault+0x105/0x310 do_user_addr_fault+0x1ee/0x750 ? __this_cpu_preempt_check+0x13/0x20 exc_page_fault+0x76/0x180 asm_exc_page_fault+0x27/0x30`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2024-03-02 22:15:49
- **Vulnerability Status**:
  - Received

## References

- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/1348f7f15d7c7798456856bee74a4235c2da994e
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/811ba2ef0cb6402672e64ba1419d6ef95aa3405d
- **416baaa9-dc9f-4396-8d5f-8c081fb06d67**: https://git.kernel.org/stable/c/c6c2adcba50c2622ed25ba5d5e7f05f584711358
