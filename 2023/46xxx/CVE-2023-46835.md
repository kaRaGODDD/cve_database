
# [CVE-2023-46835](https://xenbits.xenproject.org/xsa/advisory-445.html)

## Description

- `The current setup of the quarantine page tables assumes that thequarantine domain (dom_io) has been initialized with an address widthof DEFAULT_DOMAIN_ADDRESS_WIDTH (48) and hence 4 page table levels.However dom_io being a PV domain gets the AMD-Vi IOMMU page tableslevels based on the maximum (hot pluggable) RAM address, and hence onsystems with no RAM above the 512GB mark only 3 page-table levels areconfigured in the IOMMU.On systems without RAM above the 512GB boundaryamd_iommu_quarantine_init() will setup page tables for the scratchpage with 4 levels, while the IOMMU will be configured to use 3 levelsonly, resulting in the last page table directory (PDE) effectivelybecoming a page table entry (PTE), and hence a device in quarantinemode gaining write access to the page destined to be a PDE.Due to this page table level mismatch, the sink page the device getsread/write access to is no longer cleared between device assignment,possibly leading to data leaks.`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2024-01-05 17:15:11
- **Vulnerability Status**:
  - Analyzed

## References

- **security@xen.org**: https://xenbits.xenproject.org/xsa/advisory-445.html
